
Процедура ПриОткрытии()
	
	АктивизироватьПодробныеДанные = Ложь;
	Если НачальноеЗначениеВыбора <> Неопределено Тогда
		ЭлементыФормы.ТаблицаЖурнала.ТекущаяСтрока = НачальноеЗначениеВыбора;
		Если Истина
			И СтрокаТаблицыЗначений <> Неопределено 
			И СтрокаТаблицыЗначений.Владелец().Колонки.Найти("РазделениеДанныхСеанса") <> Неопределено
		Тогда
			ЭлементыФормы.ПредставлениеРазделенияДанныхСеанса.Значение = ирОбщий.РасширенноеПредставлениеЗначенияЛкс(СтрокаТаблицыЗначений.РазделениеДанныхСеанса);
		КонецЕсли; 
	КонецЕсли;
	Если ТипЗнч(СтрокаТаблицыЗначений.Данные) = Тип("Структура") Тогда
		Для Каждого КлючИЗначение Из СтрокаТаблицыЗначений.Данные Цикл
			СтрокаМетаданных = ПодробныеДанные.Добавить();
			СтрокаМетаданных.Свойство = КлючИЗначение.Ключ;
			СтрокаМетаданных.Значение = КлючИЗначение.Значение;
			СтрокаМетаданных.ПредставлениеЗначения = СтрокаМетаданных.Значение;
		КонецЦикла;
		АктивизироватьПодробныеДанные = Истина;
	Иначе
		СтрокаМетаданных = ПодробныеДанные.Добавить();
		СтрокаМетаданных.Свойство = "Данные";
		СтрокаМетаданных.Значение = СтрокаТаблицыЗначений.Данные;
		СтрокаМетаданных.ПредставлениеЗначения = СтрокаМетаданных.Значение;
	КонецЕсли;
	ПодробныеДанные.Сортировать("Свойство");
	СтрокаМетаданных = ПодробныеДанные.Вставить(0);
	СтрокаМетаданных.Свойство = "Метаданные";
	СтрокаМетаданных.Значение = СтрокаТаблицыЗначений.Метаданные;
	СтрокаМетаданных.ПредставлениеЗначения = СтрокаМетаданных.Значение;
	Если Истина
		И ТипЗнч(СтрокаТаблицыЗначений.Метаданные) = Тип("Массив") 
		И СтрокаТаблицыЗначений.Метаданные.Количество() > 0
	Тогда
		АктивизироватьПодробныеДанные = Истина;
	КонецЕсли; 
	Если АктивизироватьПодробныеДанные Тогда
		ЭлементыФормы.ПанельДанные.ТекущаяСтраница = ЭлементыФормы.ПанельДанные.Страницы.ПодробныеДанные;
	КонецЕсли; 
	ирОбщий.ОбновитьТекстПослеМаркераВСтрокеЛкс(ЭтаФорма.Заголовок,, "" + ЭлементыФормы.ДатаВремя.Значение + " " + ирОбщий.ПоследнийФрагментЛкс(ЭлементыФормы.ПредставлениеСобытия.Значение), ": ");
	
КонецПроцедуры

Процедура РасширенноеЗначениеОткрытие(Элемент, СтандартнаяОбработка)
	
	ЗначениеПоля = СтрокаТаблицыЗначений[ирОбщий.ПоследнийФрагментЛкс(Элемент.Данные)];
	Если ирКэш.ОбъектМДПоПолномуИмениЛкс(ЗначениеПоля) <> Неопределено Тогда
		СтандартнаяОбработка = Ложь;
		ирОбщий.ОткрытьОбъектМетаданныхЛкс(ЗначениеПоля);
	Иначе
		ирОбщий.ОткрытьЗначениеЛкс(ЗначениеПоля, Ложь, СтандартнаяОбработка);
	КонецЕсли; 

КонецПроцедуры

Процедура ПредставлениеСобытияОткрытие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	Если ЭлементыФормы.ТаблицаЖурнала.ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли; 
	Форма = ирОбщий.ПолучитьФормуЛкс("Обработка.ирНастройкаЖурналаРегистрации.Форма");
	Форма.Открыть();
	лМетаданные = Неопределено;
	Если СтрокаТаблицыЗначений <> Неопределено Тогда
		лМетаданные = СтрокаТаблицыЗначений.Метаданные;
	КонецЕсли; 
	Форма.АктивизироватьСтрокуСобытия(ЭлементыФормы.Событие.Значение, лМетаданные);
	
КонецПроцедуры

Процедура КлсУниверсальнаяКомандаНажатие(Кнопка) Экспорт 
	
	ирОбщий.УниверсальнаяКомандаФормыЛкс(ЭтаФорма, Кнопка);
	
КонецПроцедуры

Процедура ОбработчикОжиданияСПараметрамиЛкс() Экспорт 
	
	ирОбщий.ОбработчикОжиданияСПараметрамиЛкс();

КонецПроцедуры

Процедура ИмяПользователяОткрытие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ирОбщий.ОткрытьПользователяИБЛкс(ЭлементыФормы.ТаблицаЖурнала.ТекущиеДанные.ИмяПользователя);
	
КонецПроцедуры

Процедура КП_ДоступАнализПравДоступа(Кнопка)
	
	ПолноеИмяМД = ВыбратьОбъектМетаданных(СтрокаТаблицыЗначений);
	Если ПолноеИмяМД = Неопределено Тогда
		Возврат;
	КонецЕсли; 
	ФормаОтчета = ирОбщий.ПолучитьФормуЛкс("Отчет.ирАнализПравДоступа.Форма",,, ПолноеИмяМД);
	ФормаОтчета.Пользователь = СтрокаТаблицыЗначений.ИмяПользователя;
	ФормаОтчета.ОбъектМетаданных = ПолноеИмяМД;
	ФормаОтчета.ПараметрКлючВарианта = "ПоПользователям";
	ФормаОтчета.Открыть();
	
КонецПроцедуры

Процедура ОбновлениеОтображения()
	
	ирОбщий.ОбновитьЗаголовкиСтраницПанелейЛкс(ЭтаФорма);
	
КонецПроцедуры

Процедура ПодробныеДанныеПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	ирОбщий.ТабличноеПолеПриВыводеСтрокиЛкс(ЭтаФорма, Элемент, ОформлениеСтроки, ДанныеСтроки,,, Новый Структура("ПредставлениеЗначения", "Значение"));
	
КонецПроцедуры

Процедура КП_ДоступОткрытьОбъектМетаданных(Кнопка)
	
	ПолноеИмяМД = ВыбратьОбъектМетаданных(СтрокаТаблицыЗначений);
	Если ПолноеИмяМД = Неопределено Тогда
		Возврат;
	КонецЕсли; 
	ирОбщий.ОткрытьОбъектМетаданныхЛкс(ПолноеИмяМД);
	
КонецПроцедуры

Процедура КомментарийОткрытие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ирОбщий.ОткрытьТекстЛкс(Элемент.Значение,,,, СтрокаТаблицыЗначений.ПорядокСтроки);
	
КонецПроцедуры

Процедура ВнешнееСобытие(Источник, Событие, Данные)
	
	ирОбщий.Форма_ВнешнееСобытиеЛкс(ЭтаФорма, Источник, Событие, Данные);

КонецПроцедуры

ирОбщий.ИнициализироватьФормуЛкс(ЭтаФорма, "Обработка.ирАнализЖурналаРегистрации.Форма.ФормаСобытия");
ПодробныеДанные.Колонки.Добавить("Значение");